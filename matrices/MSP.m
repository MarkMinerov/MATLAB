function I = MSP(U,R)
    A = [
        R(1) + R(2) + R(3), -(R(2) + R(3)), 0;
        -(R(2) + R(3)), R(2) + R(3) + R(4), -R(4);
        0, -R(4), R(4) + R(5) + R(6) + R(7);
    ];

    B = [-U(1); 0; -U(2)];
    Is = A \ B;

    I(1) = -Is(1);
    I(2) = Is(1) - Is(2);
    I(3) = Is(2) - Is(3);
    I(4) = -Is(3);
end
